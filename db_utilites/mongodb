
from pymongo.mongo_client import MongoClient
from pymongo.server_api import ServerApi
from logger import get_logger
logger = get_logger()
uri = "mongodb://localhost:27017/"

# Create a new client and connect to the server
class MongoDB:
    def __init__(self):  
        self.client = MongoClient(uri, server_api=ServerApi('1'))

        # Send a ping to confirm a successful connection
        try:
            self.client.admin.command('ping')
            logger.info("Pinged your deployment. You successfully connected to MongoDB!")
        except Exception as e:
            logger.error(f"Error during pinging error: {e}")

    def get_collection(self, name: str):
        db = self.client[name]
        return db
    
    
        
